# マップ

みんなでつくるダンジョンの空間は、アクションゲームのステージような「マップ」で構成されます。[キャラクタ](/guide/avatar/)を設定してマップの中を自由に移動したり、じぶんでマップを作って他のマップとつなげることもできます。

## マップを構成するもの

### [アイテム](/guide/item/)
壁や床・看板などなど、マップは「[アイテム](/guide/item/)」によって構成されます。

### レイヤー
アイテムは「レイヤー」とよばれる層状の領域で管理されています。レイヤーの番号が小さいほど奥に、大きいほど手前に表示されます。

### 背景
背景はほかのアイテムと違い、キャラクター移動時のスクロール具合を調整できるので、かんたんに遠景を表現できます。

::: tip 背景のレイヤー配置
背景はレイヤー0に配置されます。
:::

### [キャラクタ](/guide/avatar/)
キャラクタを設定するとマップの中を移動することができるようになります。

::: tip キャラクタのレイヤー配置
キャラクタはレイヤー2に配置されます。
:::

### エントリポイント
[コネクタ](/guide/connector/)経由以外からマップを訪れたときにキャラクタをどの位置に配置するかを設定します。（エントリポイントがないマップは他のマップと接続できません）

![エントリポイントの追加](./images/entrypoint-navbar.png)
エントリポイントを配置するにはツールバーから「エントリポイントの追加」を選択します。

::: warning 注意
- マップが保存されていない場合はエントリポイントの追加ボタンが表示されません
- エントリポイントはマップにひとつしか配置できません（配置されているときは「エントリポイントの追加」ボタンは表示されません
- マップがほかのコネクタと接続されているときはエントリポイントの削除ができません。
:::

## マップ編集ツールバー

![ツールバー](./images/navbar.png)

マップ編集画面には、画面上部にこのようなボタンが並んでいます。

|ボタン|機能|説明|
|:--:|:--:|:--|
|![ログアウト](./images/logout-button.png)|ログアウト|ログイン中のアカウントからログアウトします|
|![マップ設定](./images/map-settings-button.png)|マップ設定|マップの大きさを設定します|
|![画像管理](./images/texture-button.png)|画像管理|画像を管理します|
|![アイテム追加](./images/item-button.png)|アイテム追加|アイテムを追加します|
|![アニメーション管理](./images/animation-button.png)|アニメーション管理|アニメーションを追加・削除します|
|![マップの保存](./images/save-button.png)|保存|編集中のマップを保存します|
|![マップの読み込み](./images/map-button.png)|マップの読み込み|保存したマップを読み込みます|
|![キャラクタの管理](./images/avatar-button.png)|キャラクタの管理|キャラクタを設定します|
|![マップの公開設定](./images/publication-button.png)|マップの公開設定|マップの公開設定をします|
|![コネクタの追加](./images/connector-button.png)|コネクタの追加|コネクタをマップに追加します|
|![エントリポイントの追加](./images/entrypoint-button.png)|エントリポイントの追加|エントリポイントをマップに追加します|
|![グリッドにスナップ](./images/grid-snapping-button.png)|グリッドにスナップ|アイテムやコネクタを配置するときにグリッドに沿って配置するかどうかを設定します|
|![レイヤー選択モード](./images/layer-select-button.png)|レイヤー選択モード|レイヤーを選択して編集したいときに有効にします。指定レイヤーのアイテムのみ選択できるようになります。|


## マップをひらく

マップをひらくにはツールバーの「マップをひらく」ボタンを押します。
![マップを開く](./images/open-map-navbar.png)

表示されるマップ一覧から読み込みたいマップを選択してください。

## マップサイズの変更
ツールバーの「マップの設定」をクリックします。

![マップの設定](./images/map-settings-navbar.png)

表示された画面でマップサイズを変更できます。

![マップ設定画面](./images/map-settings-window.png)

- マップサイズは面積が1500x1500pxが最大値です。たとえば幅を小さくするとその分高さを大きく取ることができます。
- 「横に長い」「縦に長い」「正方形」ボタンは、それぞれマップサイズを適当に調整します。
- 適用ボタンをクリックすると適用されます。

## 背景の設定

::: tip おしらせ
背景としてつかいたいアニメーションを予め登録しておく必要があります。
:::

キャラクター移動時のスクロール具合を調整できるので、かんたんに遠景を表現できます。背景はレイヤー0に配置されます。

![背景の追加](./images/background-button-navbar.png)

設定したいアニメーションを選択します。「スクロール量」を1より小さくすると、背景のスクロールがキャラクター移動によるスクロールに対して遅くなるので、遠景を表現することができます。

![背景設定ウインドウ](./images/background-window.png)

## BGMの設定

:::tip おしらせ
BGMとしてつかいたい[サウンドを予め登録](/guide/sound/)しておく必要があります
:::

ツールバーの「マップの設定」をクリックします。

![マップの設定](./images/map-settings-navbar.png)

表示された画面でBGMを設定できます。

![マップ設定画面](./images/map-settings-window.png)

## つくったマップであそんでみる
![このマップを探検するボタン](./images/play-map-navbar.png)
作ったマップをキャラクタで探検するには、ツールバーから「このマップを探検する」をクリックします。

::: warning 注意
- [キャラクタが設定](/guide/avatar/)されていないときはマップを探検することができません。
- マップが保存されていない場合は「このマップを探検する」ボタンが表示されません。
:::

## 公開設定
ほかのひとに自分のマップをつなげてもらうには、「公開設定」をする必要があります。ほかのユーザーが[接続コネクタを選択](/guide/connector/#ほかのひとのマップと接続)するときに、公開状態のマップが選べるようになります。

::: warning 注意
ほかのひとがあなたの公開状態マップに接続した後にマップを非公開にしても、接続状態は維持され、マップ間移動はできるままになります。移動を禁止したい場合は、[該当コネクタの公開設定を非公開状態](/guide/connector/#公開設定)にするか、接続を解除する必要があります。
コネクタの公開設定については[コネクタ#公開設定](/guide/connector/#公開設定)を参照してください。
:::

![マップの公開設定](./images/map-publication-navbar.png)

ツールバーの「マップの公開設定」をクリックします。表示される選択ウインドウからマップの公開設定をして、マップを保存してください。
